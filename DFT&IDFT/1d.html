<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kalkulator DFT & IDFT 1D</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    window.MathJax = { tex: { inlineMath: [['$', '$']], displayMath: [['$$', '$$']] }, svg: { fontCache: 'global' } };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style> body { background-color: #f0f4f8; } </style>
</head>
<body>
  <div id="root">
    <div class="min-h-screen bg-gray-100 font-sans text-gray-800">
      <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4">
           <div class="flex justify-between items-center">
             <a href="index.html" class="text-blue-600 hover:underline">&larr; Kembali ke Halaman Utama</a>
             <div></div>
           </div>
          <h1 class="text-3xl sm:text-4xl font-extrabold text-center text-gray-900 tracking-tight -mt-6">
            Kalkulator DFT & IDFT 1 Dimensi
          </h1>
          <p class="text-center text-gray-500 mt-2">Demonstrasi perhitungan DFT dan IDFT 1D langkah demi langkah.</p>
        </div>
      </header>
      
      <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="flex justify-center flex-wrap border-b border-gray-300 mb-8">
            <button id="tab-dft" class="tab-button px-4 py-3 text-base sm:text-lg font-semibold rounded-t-lg bg-blue-600 text-white">1D DFT</button>
            <button id="tab-idft" class="tab-button px-4 py-3 text-base sm:text-lg font-semibold rounded-t-lg text-gray-600 hover:bg-gray-200">1D IDFT</button>
        </div>

        <div id="content-dft" class="tab-content"></div>
        <div id="content-idft" class="tab-content hidden"></div>
      </main>

      <footer class="text-center py-6 text-gray-500 text-sm">
        <p>Generated by a world-class senior frontend React engineer.</p>
      </footer>
    </div>
  </div>

<script>
// --- UTILITY CLASSES AND FUNCTIONS (Complex, gcd, parseComplexString) ---
const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
const reduceFraction = (numerator, denominator) => {
    if (denominator === 0) return [numerator, denominator];
    if (numerator === 0) return [0, 1];
    const commonDivisor = Math.abs(gcd(Math.round(numerator), Math.round(denominator)));
    return [Math.round(numerator / commonDivisor), Math.round(denominator / commonDivisor)];
};
class Complex {
  constructor(real, imag) { this.real = real; this.imag = imag; }
  add(c) { return new Complex(this.real + c.real, this.imag + c.imag); }
  multiply(c) {
    const real = this.real * c.real - this.imag * c.imag;
    const imag = this.real * c.imag + this.imag * c.real;
    return new Complex(real, imag);
  }
  multiplyScalar(s) { return new Complex(this.real * s, this.imag * s); }
  toString(precision = 2) {
    const realPart = parseFloat(this.real.toFixed(precision));
    const imagPart = parseFloat(this.imag.toFixed(precision));
    if (Math.abs(realPart) < 1e-9 && Math.abs(imagPart) < 1e-9) return '0';
    if (Math.abs(imagPart) < 1e-9) return `${realPart}`;
    if (Math.abs(realPart) < 1e-9) {
        if (imagPart === 1) return 'i';
        if (imagPart === -1) return '-i';
        return `${imagPart}i`;
    }
    const imagSign = imagPart < 0 ? '-' : '+';
    const imagVal = Math.abs(imagPart);
    if (imagVal === 1) return `${realPart} ${imagSign} i`;
    return `${realPart} ${imagSign} ${imagVal}i`;
  }
  static fromEuler(theta) { return new Complex(Math.cos(theta), Math.sin(theta)); }
}
const parseComplexString = (s) => {
    s = s.trim();
    if (s === 'i') return new Complex(0, 1);
    if (s === '-i') return new Complex(0, -1);
    if (s === '') return null;
    const match = s.match(/^(-?\d+\.?\d*)\s*([+-])\s*(\d*\.?\d*)?i$/);
    if (match) {
        const real = parseFloat(match[1]);
        const sign = match[2] === '+' ? 1 : -1;
        const imag = match[3] ? parseFloat(match[3]) : 1;
        return new Complex(real, sign * imag);
    }
    const imagMatch = s.match(/^(-?\d*\.?\d*)i$/);
    if (imagMatch) {
        const imagVal = imagMatch[1];
        if (imagVal === '-') return new Complex(0, -1);
        if (imagVal === '' || imagVal === '+') return new Complex(0, 1);
        return new Complex(0, parseFloat(imagVal));
    }
    const realMatch = s.match(/^-?\d+\.?\d*$/);
    if (realMatch) return new Complex(parseFloat(s), 0);
    return null;
};
// --- 1D CALCULATION LOGIC ---
const generateDFTCalculation = (signal) => {
    const M = signal.length;
    if (M === 0) return { steps: [], result: [], signal };
    const steps = [];
    const finalResult = [];

    for (let u = 0; u < M; u++) {
        let step = { u, title: `Langkah untuk u = ${u}` };
        let finalValue = new Complex(0, 0);
        
        const n = -2 * u;
        const [num_pi, den] = reduceFraction(n, M);
        let pi_frac_str = num_pi !== 0 ? `\\frac{${num_pi}i\\pi x}{${den}}` : '0';
        if (den === 1) pi_frac_str = `${num_pi}i\\pi x`;

        step.formula = `$$ F(${u}) = \\sum_{x=0}^{${M-1}} f(x) \\cdot e^{${pi_frac_str}} $$`;
        
        let expansion = '', substitution = '', euler = '', trigValues = '', simplification = '';

        for (let x = 0; x < M; x++) {
            const theta = (-2 * Math.PI * u * x) / M;
            const expTerm = Complex.fromEuler(theta);
            const term = expTerm.multiplyScalar(signal[x]);
            finalValue = finalValue.add(term);
            
            const n_x = -2 * u * x;
            const [num_pi_x, den_x] = reduceFraction(n_x, M);
            let pi_frac_x_str = '0';
            if (num_pi_x !== 0) pi_frac_x_str = den_x === 1 ? `${num_pi_x}i\\pi` : `\\frac{${num_pi_x}i\\pi}{${den_x}}`;

            expansion += `f(${x})e^{${pi_frac_x_str}}`;
            substitution += `${signal[x]}(e^{${pi_frac_x_str}})`;
            
            const [cos_num, cos_den] = reduceFraction(u*x, M);
            let cos_arg = '0';
            if(cos_num !== 0) cos_arg = cos_den === 1 ? `${cos_num}\\pi` : `\\frac{${cos_num}\\pi}{${cos_den}}`;

            euler += `${signal[x]}(\\cos(${cos_arg}) - i\\sin(${cos_arg}))`;
            trigValues += `${signal[x]}(${parseFloat(expTerm.real.toFixed(3))} ${expTerm.imag < 0 ? '-' : '+'} i(${parseFloat(Math.abs(expTerm.imag).toFixed(3))}))`;
            simplification += `(${term.toString()})`;

            if (x < M - 1) {
                expansion += ' + '; substitution += ' + '; euler += ' + ';
                trigValues += ' + '; simplification += ' + ';
            }
        }
        step.expansion = `$$ F(${u}) = ${expansion} $$`;
        step.substitution = `$$ F(${u}) = ${substitution} $$`;
        if (u > 0 || M === 1) {
            step.euler = `$$ F(${u}) = ${euler} $$`;
            step.trigValues = `$$ F(${u}) = ${trigValues} $$`;
            step.simplification = `$$ F(${u}) = ${simplification} $$`;
        }
        step.result = `$$ F(${u}) = ${finalValue.toString()} $$`;
        steps.push(step);
        finalResult.push(finalValue);
    }
    return { steps, result: finalResult, signal };
};

const generateIDFTCalculation = (signal) => {
    const M = signal.length;
    if (M === 0) return { steps: [], result: [], signal };
    const steps = [];
    const finalResult = [];

    for (let x = 0; x < M; x++) {
        let step = { x, title: `Langkah untuk x = ${x}` };
        let finalValue = new Complex(0, 0);
        
        const n = 2 * x;
        const [num_pi, den] = reduceFraction(n, M);
        let pi_frac_str = num_pi !== 0 ? `\\frac{${num_pi}i\\pi u}{${den}}` : '0';
        if (den === 1) pi_frac_str = `${num_pi}i\\pi u`;

        step.formula = `$$ f(${x}) = \\frac{1}{${M}} \\sum_{u=0}^{${M-1}} F(u) \\cdot e^{${pi_frac_str}} $$`;

        let expansion = '', substitution = '', simplification = '';
        for (let u = 0; u < M; u++) {
            const theta = (2 * Math.PI * u * x) / M;
            const expTerm = Complex.fromEuler(theta);
            const term = signal[u].multiply(expTerm);
            finalValue = finalValue.add(term);
            
            const n_x = 2 * u * x;
            const [num_pi_x, den_x] = reduceFraction(n_x, M);
            let pi_frac_x_str = '0';
            if (num_pi_x !== 0) pi_frac_x_str = den_x === 1 ? `${num_pi_x}i\\pi` : `\\frac{${num_pi_x}i\\pi}{${den_x}}`;

            expansion += `F(${u})e^{${pi_frac_x_str}}`;
            substitution += `(${signal[u].toString()})(e^{${pi_frac_x_str}})`;
            simplification += `(${term.toString()})`;

            if (u < M - 1) {
                expansion += ' + '; substitution += ' + '; simplification += ' + ';
            }
        }
        
        const scaledFinalValue = finalValue.multiplyScalar(1/M);
        step.expansion = `$$ f(${x}) = \\frac{1}{${M}} [${expansion}] $$`;
        step.substitution = `$$ f(${x}) = \\frac{1}{${M}} [${substitution}] $$`;
        step.simplification = `$$ f(${x}) = \\frac{1}{${M}} [${simplification}] $$`;
        step.result = `$$ f(${x}) = \\frac{1}{${M}} (${finalValue.toString()}) = ${scaledFinalValue.toString()} $$`;

        steps.push(step);
        finalResult.push(scaledFinalValue);
    }
    return { steps, result: finalResult, signal };
};

// --- DOM Manipulation & Event Handling ---
document.addEventListener('DOMContentLoaded', () => {
    const tabs = { dft: document.getElementById('tab-dft'), idft: document.getElementById('tab-idft') };
    const contents = { dft: document.getElementById('content-dft'), idft: document.getElementById('content-idft') };
    let activeTab = 'dft';
    let idftInitialInput = null;

    function switchTab(tabId) {
        Object.values(tabs).forEach(tab => {
            tab.classList.remove('bg-blue-600', 'text-white');
            tab.classList.add('text-gray-600', 'hover:bg-gray-200');
        });
        tabs[tabId].classList.add('bg-blue-600', 'text-white');
        tabs[tabId].classList.remove('text-gray-600', 'hover:bg-gray-200');

        Object.values(contents).forEach(content => content.classList.add('hidden'));
        contents[tabId].classList.remove('hidden');
        
        activeTab = tabId;
        renderContent();
    }

    Object.keys(tabs).forEach(tabId => tabs[tabId].addEventListener('click', () => switchTab(tabId)));

    function renderContent() {
        if (activeTab === 'dft') renderDFT();
        if (activeTab === 'idft') renderIDFT(idftInitialInput);
    }
    
    function renderDFT() {
        contents.dft.innerHTML = `
        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-4">Sinyal Asli / Domain Spasial (Input)</h2>
            <div class="text-lg text-gray-700 space-y-4">
              <p>Masukkan sinyal input 1D $f(x)$ sebagai nilai yang dipisahkan koma.</p>
              <form id="dft-form" class="mt-4 space-y-4">
                  <div>
                      <label for="signalInput" class="block text-sm font-medium text-gray-700 mb-1">Input Sinyal $f(x)$:</label>
                      <input id="signalInput" type="text" value="1, 4, 2, 2" placeholder="e.g., 1, 4, 2, 2" class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-mono text-white placeholder-gray-400" />
                      <p id="dft-error" class="text-red-600 text-sm mt-2"></p>
                  </div>
                  <button type="submit" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700">Hitung DFT</button>
              </form>
              <div id="dft-calculation-output" class="mt-6"></div>
            </div>
        </div>`;
        document.getElementById('dft-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const inputValue = document.getElementById('signalInput').value;
            const errorEl = document.getElementById('dft-error');
            const outputEl = document.getElementById('dft-calculation-output');
            errorEl.textContent = ''; outputEl.innerHTML = '';
            if (inputValue.trim() === '') { errorEl.textContent = 'Input tidak boleh kosong.'; return; }
            const numbers = inputValue.split(',').map(s => s.trim()).filter(s => s !== '').map(Number);
            if (numbers.some(isNaN)) { errorEl.textContent = 'Input harus berupa angka yang dipisahkan koma.'; return; }
            if (numbers.length === 0) { errorEl.textContent = 'Harap masukkan setidaknya satu angka.'; return; }
            const calculationData = generateDFTCalculation(numbers);
            displayDFTResults(calculationData, outputEl);
            MathJax.typeset();
        });
    }

    function displayDFTResults(data, container) {
        let html = `<div class="mt-6">
                 <p>Sinyal yang sedang dihitung:</p>
                  <div class="flex justify-center items-center bg-gray-50 p-4 rounded-lg my-2 border"><span class="text-2xl font-mono">$f(x) = [${data.signal.join(', ')}]$</span></div>
             </div>
          <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 my-8">
            <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-4">Rumus Discrete Fourier Transform (DFT)</h2>
            <div class="text-lg text-gray-700 space-y-4">
              <p>DFT mengubah sinyal dari domain spasial ke domain frekuensi.</p>
              <div class="text-center bg-gray-50 p-4 rounded-lg my-4 border"><p class="text-2xl">$$ F(u) = \\sum_{x=0}^{M-1} f(x) \\cdot e^{\\frac{-i2\\pi ux}{M}} $$</p></div>
              <ul class="list-disc list-inside bg-gray-50 p-4 rounded-lg border">
                  <li>$F(u)$ adalah hasil transformasi pada frekuensi $u$.</li>
                  <li>$f(x)$ adalah nilai sinyal pada posisi $x$.</li>
                  <li>$M$ adalah jumlah total sampel. Untuk input ini, $M=${data.signal.length}$.</li>
              </ul>
            </div>
          </div>
          <div>
              <h2 class="text-3xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-6 mt-12">Langkah-langkah Perhitungan DFT</h2>
              ${data.steps.map(step => `<div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
                    <h3 class="text-xl font-semibold text-blue-700 mb-4">${step.title}</h3>
                    <div class="space-y-3 text-gray-800 overflow-x-auto pb-2">
                        ${step.formula ? `<p>${step.formula}</p>` : ''}
                        ${step.expansion ? `<p>${step.expansion}</p>` : ''}
                        ${step.substitution ? `<p>${step.substitution}</p>` : ''}
                        ${step.euler ? `<p>${step.euler}</p>` : ''}
                        ${step.trigValues ? `<p>${step.trigValues}</p>` : ''}
                        ${step.simplification ? `<p>${step.simplification}</p>` : ''}
                        ${step.result ? `<p class="font-bold text-blue-600 pt-2">${step.result}</p>` : ''}
                    </div>
                </div>`).join('')}
          </div>
          <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-4">Hasil Akhir: Spektrum Frekuensi (Output)</h2>
            <div class="text-lg text-gray-700 space-y-4">
              <p>Hasil DFT lengkap dalam domain frekuensi.</p>
              <div class="flex justify-center items-center bg-gray-50 p-4 rounded-lg my-4 border overflow-x-auto"><span class="text-2xl font-mono">$F(u) = [${data.result.map(c=>c.toString()).join(',\\ ')}]$</span></div>
              <button id="copy-to-idft" class="w-full mt-4 bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Salin sebagai Input IDFT</button>
            </div>
          </div>`;
        container.innerHTML = html;
        document.getElementById('copy-to-idft').addEventListener('click', () => {
            idftInitialInput = data.result;
            switchTab('idft');
        });
    }

    function renderIDFT(initialInput = null) {
        const initialValue = initialInput ? initialInput.map(c => c.toString()).join(', ') : '';
        contents.idft.innerHTML = `<div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-4">Sinyal Domain Frekuensi (Input)</h2>
            <div class="text-lg text-gray-700 space-y-4">
              <p>Masukkan spektrum frekuensi 1D $F(u)$ sebagai nilai (bisa kompleks) yang dipisahkan koma.</p>
              <form id="idft-form" class="mt-4 space-y-4">
                  <div>
                      <label for="signalInputIDFT" class="block text-sm font-medium text-gray-700 mb-1">Input Spektrum $F(u)$:</label>
                      <input id="signalInputIDFT" type="text" value="${initialValue}" placeholder="e.g., 9, -1 + 2i, -3, -1 - 2i" class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md font-mono text-white" />
                      <p id="idft-error" class="text-red-600 text-sm mt-2"></p>
                  </div>
                  <button type="submit" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700">Hitung IDFT</button>
              </form>
              <div id="idft-calculation-output" class="mt-6"></div>
            </div>
        </div>`;
        document.getElementById('idft-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const inputValue = document.getElementById('signalInputIDFT').value;
            const errorEl = document.getElementById('idft-error');
            const outputEl = document.getElementById('idft-calculation-output');
            errorEl.textContent = ''; outputEl.innerHTML = '';
            if (inputValue.trim() === '') { errorEl.textContent = 'Input tidak boleh kosong.'; return; }
            const complexNumbers = inputValue.split(',').map(s => parseComplexString(s.trim()));
            if (complexNumbers.some(c => c === null)) { errorEl.textContent = 'Format input kompleks tidak valid.'; return; }
            const calculationData = generateIDFTCalculation(complexNumbers);
            displayIDFTResults(calculationData, outputEl);
            MathJax.typeset();
        });
        if (initialInput) document.getElementById('idft-form').dispatchEvent(new Event('submit'));
    }

    function displayIDFTResults(data, container) {
         let html = `<div class="mt-6">
                 <p>Spektrum yang sedang dihitung:</p>
                  <div class="flex justify-center items-center bg-gray-50 p-4 rounded-lg my-2 border"><span class="text-2xl font-mono">$F(u) = [${data.signal.map(c=>c.toString()).join(', ')}]$</span></div>
             </div>
          <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 my-8">
            <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-4">Rumus Inverse Discrete Fourier Transform (IDFT)</h2>
            <div class="text-lg text-gray-700 space-y-4">
              <p>IDFT mengubah sinyal dari domain frekuensi kembali ke domain spasial.</p>
              <div class="text-center bg-gray-50 p-4 rounded-lg my-4 border"><p class="text-2xl">$$ f(x) = \\frac{1}{M} \\sum_{u=0}^{M-1} F(u) \\cdot e^{\\frac{i2\\pi ux}{M}} $$</p></div>
              <ul class="list-disc list-inside bg-gray-50 p-4 rounded-lg border">
                  <li>$f(x)$ adalah sinyal asli yang direkonstruksi.</li>
                  <li>$F(u)$ adalah nilai spektrum pada frekuensi $u$.</li>
                  <li>$M$ adalah jumlah total sampel. Untuk input ini, $M=${data.signal.length}$.</li>
              </ul>
            </div>
          </div>
          <div>
              <h2 class="text-3xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-6 mt-12">Langkah-langkah Perhitungan IDFT</h2>
              ${data.steps.map(step => `<div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
                    <h3 class="text-xl font-semibold text-blue-700 mb-4">${step.title}</h3>
                    <div class="space-y-3 text-gray-800 overflow-x-auto pb-2">
                        ${step.formula ? `<p>${step.formula}</p>` : ''}
                        ${step.expansion ? `<p>${step.expansion}</p>` : ''}
                        ${step.substitution ? `<p>${step.substitution}</p>` : ''}
                        ${step.simplification ? `<p>${step.simplification}</p>` : ''}
                        ${step.result ? `<p class="font-bold text-blue-600 pt-2">${step.result}</p>` : ''}
                    </div>
                </div>`).join('')}
          </div>
          <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-blue-500 pb-2 mb-4">Hasil Akhir: Sinyal Asli Direkonstruksi</h2>
            <div class="text-lg text-gray-700 space-y-4">
              <p>Hasil IDFT, yang seharusnya menjadi sinyal asli (dengan sedikit kesalahan pembulatan).</p>
              <div class="flex justify-center items-center bg-gray-50 p-4 rounded-lg my-4 border overflow-x-auto"><span class="text-2xl font-mono">$f(x) = [${data.result.map(c=>c.toString()).join(',\\ ')}]$</span></div>
            </div>
          </div>`;
        container.innerHTML = html;
    }
    
    // Initial render
    renderContent();
    MathJax.typeset();
});
</script>
</body>
</html>